# Final project instructions

### due Tuesday, May 11 at 3 pm *sharp*

## Overview

Everyone will work with the same **two datasets** which will test you on content learned throughout the entire semester. Respond clearly to each of the data-based and written questions.

In general, **do this like you would a homework (see 'Importan: Special instructions' below)**

- Syllabus instructions on how to display your answers to computational questions apply here as well. Please review this in the syllabus, as I will be less lenient about it than for homework.

- Written answers must be clearly argued using concepts from the course.

## Important: Special instructions

### Submit your homework on Sakai, in the 'final' assignment
Since I must ensure grades are returned in a timely manner, I can't risk running into OneDrive's nonsense buggy behavior.

#### Excel: Submit two files with these *exact* names

`youronyen` is a placeholder for your *exact* onyen, all lower case.

- `youronyen_canopy.xlsx`
- `youronyen_salaries.xlsx`

#### Python: Submit one file
Don't forget to convert to html.

- `youronyen_final.html`

**Note on written answers:** Do not place answers to written comments as code comments in the notebook. Make a markdown chunk and place your answers there. See chunk types in the menu bar for JupyterLab with 'code', 'markdown', 'raw'.

### Honor code, open-book test-like conditions

- Unlike for homework, **you must work on this alone. No collaboration or communication among students about topics related to this project is allowed whatsoever.**

- you can however use various online sources to help you with excel or python, as we've done for homework.

- **explicitely disallowed are asking for or gathering help for this project on any online forums**.

Running afoul of these policies will be considered a potential honor code violation.

### Common mistakes you should avoid
Remember: Doing these will get you **zero** credit for the response. See the syllabus and my many reminders throughout the semester.

- do not hard-code answers that should be given by a function or cell reference (in excel).
- in particular, do not write in approximate z scores such as 1.96.
- do not use a separate calculation tool for p-values. instead use a function in your tool of choice.



## Data

### `salaries`
Every UNC Chapel Hill employee is a public employee, whose salary and basic employment information is public record. The UNC System makes this information available to the public.

#### what
See the description in the link below for how and when these data are collected.

- observations: each row represents a person employed in a position at UNC Chapel Hill

- variables: Most variables are self-explanatory, but here are some details on the important ones for this exercise
    - `annual_base_salary` is the gross amount (before taxes and payroll deductions) this person is to be paid over the course of a year. It does not reflect how much a person received in income that year at the time the data were collected. See the link below for more details on what this variable does and does not include.

    - `hire_year` is the year in which this person was hired *for the position listed.*

#### source with additional information

https://uncdm.northcarolina.edu/salaries/index.php

### `canopy`
The xlsx and csv files are on the github site in the `canopy` subfolder of the `final_project` folder.

We will be exploring the proportion of tree coverage in Orange and Durham counties. The NCLD generates this data for the entire United States, based on data collected by the U.S. Forest Service.

#### what
- observations: each row represents a single 30 by 30 meter square of surface area
- variables:
    - `value`: percentage tree canopy cover estimate generated by NCLD from U.S. Forest Service data, from 0 to 100
    - `county`: identifier for county to which the observation belongs

To understand what tree canopy coverage means: Imagine a bird's eye view of the county from above, picturing it on a flat surface (even though the curvature of the earth actually is relevant this scale.) Trees will show up as green blobs obscuring some portion of the earth's surface, though not all green is from trees of course.  Non-tree areas might include bodies of water, parking lots, malls, rock formations etc. The estimated proportion of area covered by trees in this view, within each 30x30 meter square, is the `value` variable.



#### tree canopy research
If this topic interests you, check out the organization [Trees Durham](https://www.treesdurham.org/durhamtreeresearch.html) and some research posted there.

#### images
To get a sense of what this data look like when plotted as raster images:

In the pictures below, the `value` number is plotted in each 30x30 square from light to dark. The light green border around each county represents `value == 0`. There are some cells with `value == 0` within the county, for example in the middle of a lake. Darker shades represent higher `value`.

![](./canopy/durham.jpeg?raw=True)

![](./canopy/orange.jpeg?raw=True)

#### Dataset size and excel

The full dataset has more than 1.5 M rows. This exceeds [Excel's maximum capacity](https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3) of about 1.05M rows.

Excel users are given a randomly sampled set of 1M + 1 rows.

**If your Excel application is struggling**, in particular on the browser, close as many other browser tabs and other running applications as you can to free up memory and computing resources. I was able to do this assignment in the browser without much trouble.

#### source with additional information

https://www.mrlc.gov/data/nlcd-2016-usfs-tree-canopy-cover-conus



# Total: 100 points

# Part one (50 points): UNC Chapel Hill salaries

## Q1 (5 points)

- **load the dataset** (Excel users *must* use the appropriate file name as give in the instructions)
- **read** information about the dataset in the link above
- **briefly describe,** based solely on the information in that link, whether or not you could answer the following question with this dataset: 

>>> At UNC Chapel Hill, do professors have higher incomes than assistant professors?

## Q2 (5 points)

- **create** using the `hire_year` variable a new variable called `empl_years` which is number of years since `hire_year` 
- for each of the variables in the list below, **calculate and display** the following summary statistics
    - 10th quantile
    - median
    - 90th quantile
    - mean
    - variance
    

**variables to summarize**

- `age`
- `annual_base salary`
- `empl_years`

## Q3 (5 points)
The plots in this question must be reasonably **legible**, meaning it should be clear which variable is being plotted (e.g. with a title or axis label) and give decent information on the distribution of values by appropriate scale/bin choices. You do not need to fine-tune these choices. Anything reasonable is fine. Unreasonable choices of bins, for example, are ones in which the data end up split into to blobs for some big value and another for all other values. The clue to what is reasonable is that you should be able to answer the written question from your plot without too much trouble.

- plot **histograms** for 
    - `age`
    - `annual_base salary`
    
- **briefly explain** the ways in which the histograms are consistent with the the mean, median and variance summary statistics from Q2.

## Q4 (2.5 points)

**Display the following variables**

- `age`
- `annual_base_salary`
- `empl_years`
- `job_category`

**for the 10 observations** with the highest `annual_base_salary` values.

Excel users: You should copy-paste the values after sorting the data into a separate location, to make clear your response to this question. That is OK for this question.

## Q5 (5 points)

Within groups defined by `job_category`, calculate

- mean `age`
- mean `annual_base_salary`
- mean `empl_years`
- number of observations

## Q6 (7.5 points)

- **List** the top 10 job categories by mean of `annual_base_salary`, using your answer to Q5
- **Compare** this list with the top-10 list from Q4. Specifically, are the job categories represented the same? How can you explain the differences or similarities?

Hint: Use the definition of the mean.


## Q7 (5 points)
Your plot must be reasonably legible and have a decent title.

- **make a scatterplot** of mean `age` vs  mean `annual_base_salary` from the data in Q5.

## Q8 (2.5 points)
Your plot must be reasonably legible and have a decent title.

- **make a scatterplot** of mean `age` vs  mean `annual_base_salary` from the data in Q5.

## Q9 (5 points)

Calculate the correlation between mean `age` and mean `annual_base_salary`, the two variables plotted in Q8.

- **explain briefly** why the correlation calculated does or does not make sense with the plot, explicitly using concepts from class

## Q10 (7.5 points)
You may complete this and Q9 together.

- **calculate** correlations between all possible pairs of the subgroup mean summary variables in Q5.
- based on that information, **explain briefly** whether `empl_years` is or is not a possible 'confounding' or 'lurking' variable for the purpose of understanding correlation between `age` and `annual_base_salary`.

Again: Be as specific as possible and use concepts from class.


# Part two (50 points): Tree canopy in Orange and Durham counties

## Q1 (5 points)
Urban tree advocates once set a target of 40 percent coverage. Now, [goals are more place-specific](https://www.americanforests.org/blog/no-longer-recommend-40-percent-urban-tree-canopy-goal/).

- **load** the dataset
- **create** a new variable called `tree_target` which is 0 (or False in python) when `value < 40` and 1 (or True) otherwise
- **calculate** and display by county
    - average tree coverage percentage
    - average of `tree_target`
    - number of observations, i.e. number of 30x30 meter cells
    
## Q2 (7.5 points)

Suppose you were to take 100 independent random samples with replacement **of size 20 rows each from Durham county**. You **do not need to do this yourself**. This is a purely theoretical question.

- **explain briefly** what an appropriate distribution is for the **number of observations in each sample of size 20 such that `tree_target` is 1 (or True)** --- meaning the number  of randomly sampled square patches of Durham county meeting the 40-percent tree coverage guideline

- using the data from Q1, give **point estimates for the parameters of this 'appropriate distribution'**

- calcuate a **point estimate for the expectation (theoretical mean)** of this 'appropriate distribution'


## Q3 (7.5 points)

For the 'appropriate distribution' determined in Q2:

- **draw** a random sample of size 100 from the 'appropriate distribution' using the point estimates of Q2 in place of the true parameters
- **calculate** the sample mean across these 100 observations
- **briefly explain** why this sample average should or should not be close to the expectation calculated in Q2, using concepts from class

You can still get full credit for this question even if your answer to Q2 is wrong, so long as this answer is consistent with your answer in Q2.


## Q3 (10 points)

- **create a random sample** from the dataset of size **100 observations**. I will refer to this as 'sample 0'
- **create a random sample** from the dataset of size **20 observations**. I will refer to this as sample 1.
- for each sample, **calculate by county**
    - the mean of `value`, meaning the average tree canopy coverage
    - the standard deviation of `value`
    - the number of samples from each county
    - the standard error for the appropriate sample size --- in other words, give a point estimate for the standard deviation for the mean of a random sample of size 100 and 20, respectively
    
## Q4 (10 points)

- for each of your two samples, **calculate a 92 percent confidence interval for the Durham county mean of `value`** centered at the point estimate of the mean calculated in Q3
- compare these two confidence intervals, and **explain why they differ** in size --- if in fact they do

## Q5 (10 points)
Remember the two-sided difference of means test has null hypothesis `H_0: m_1 = m_0` and alternative that `m_1` is not equal to `m_0`.

- for each of your two samples, **calculate a p-value for the two-sided normal distribution-based difference of means test** between the average tree cover between Orange and Durham counties
- in each case, **briefly explain whether you can or cannot reject** the null hypothesis at `alpha = 0.075` level. 

- **briefly explain** which of your two results (one from sample 0 or sample 1) you would rather base any conclusions on. This can be a very simple answer, but it should clearly state a concept from class about why one would be preferred to the other.

**Note:** you might wish to write the accept/reject answer within an 'if' function (or use a logical <= , >= whatever in python) because your randomly sampled values might change the outcome if run multiple times.
